# 交叉循环生成教程

本教程将指导您如何使用可视化编辑器生成复杂的交叉循环JSON数据。

## 用户需求示例

生成如下格式的JSON数据：
```json
{
  "key": 1,
  "name": "d4ad2034ddess-2-tvoc",
  "sadd": 2,
  "rtype": 3,
  "radd": 100,
  "dtype": 1,
  "magn": "1",
  "report": 0,
  "ampl": "0"
}
```

### 字段说明
- `key`: 递增字段（1, 2, 3...）
- `name`: 组合字段，格式为 "固定前缀-sadd值-对象名称"
- `sadd`: 范围遍历值（如1-3）
- `radd`: 来自对象列表的字段值
- 其他字段: 固定值

## 可视化编辑器配置步骤

### 1. 基本信息配置
- **规则名称**: 传感器数据交叉生成
- **规则ID**: sensor-cross-data
- **生成数量**: 1（由循环控制实际数量）
- **规则描述**: 生成传感器与范围值的交叉组合数据

### 2. 添加交叉循环
点击"添加循环" → 选择"交叉循环"，配置参数：
- **对象列表**: 
  ```json
  [
    { "name": "tvoc", "radd": 100 },
    { "name": "pm25", "radd": 200 },
    { "name": "co2", "radd": 300 }
  ]
  ```
- **范围开始**: 1
- **范围结束**: 3
- **范围步长**: 1

### 3. 配置循环内的字段

在循环模板中添加以下字段：

#### key字段
- **字段名**: key
- **字段类型**: 数字
- **生成器**: 递增序号
- **起始值**: 1

#### name字段
- **字段名**: name
- **字段类型**: 字符串
- **生成器**: 模板字符串
- **模板**: d4ad2034ddess-{{$range}}-{{$obj.name}}

#### sadd字段
- **字段名**: sadd
- **字段类型**: 数字
- **生成器**: 范围值

#### radd字段
- **字段名**: radd
- **字段类型**: 数字
- **生成器**: 对象字段
- **字段名**: radd

#### 其他固定字段
- **rtype**: 固定值 3
- **dtype**: 固定值 1
- **magn**: 固定值 "1"
- **report**: 固定值 0
- **ampl**: 固定值 "0"

### 4. 生成规则
点击"生成规则"按钮，系统会自动生成对应的JSON模板。

## 生成结果

配置完成后，将生成9条记录（3个对象 × 3个范围值）：

```json
[
  { "key": 1, "name": "d4ad2034ddess-1-tvoc", "sadd": 1, "rtype": 3, "radd": 100, "dtype": 1, "magn": "1", "report": 0, "ampl": "0" },
  { "key": 2, "name": "d4ad2034ddess-2-tvoc", "sadd": 2, "rtype": 3, "radd": 100, "dtype": 1, "magn": "1", "report": 0, "ampl": "0" },
  { "key": 3, "name": "d4ad2034ddess-3-tvoc", "sadd": 3, "rtype": 3, "radd": 100, "dtype": 1, "magn": "1", "report": 0, "ampl": "0" },
  { "key": 4, "name": "d4ad2034ddess-1-pm25", "sadd": 1, "rtype": 3, "radd": 200, "dtype": 1, "magn": "1", "report": 0, "ampl": "0" },
  { "key": 5, "name": "d4ad2034ddess-2-pm25", "sadd": 2, "rtype": 3, "radd": 200, "dtype": 1, "magn": "1", "report": 0, "ampl": "0" },
  { "key": 6, "name": "d4ad2034ddess-3-pm25", "sadd": 3, "rtype": 3, "radd": 200, "dtype": 1, "magn": "1", "report": 0, "ampl": "0" },
  { "key": 7, "name": "d4ad2034ddess-1-co2", "sadd": 1, "rtype": 3, "radd": 300, "dtype": 1, "magn": "1", "report": 0, "ampl": "0" },
  { "key": 8, "name": "d4ad2034ddess-2-co2", "sadd": 2, "rtype": 3, "radd": 300, "dtype": 1, "magn": "1", "report": 0, "ampl": "0" },
  { "key": 9, "name": "d4ad2034ddess-3-co2", "sadd": 3, "rtype": 3, "radd": 300, "dtype": 1, "magn": "1", "report": 0, "ampl": "0" }
]
```

## 新增生成器说明

### 递增序号
- 生成从指定起始值开始的递增数字
- 参数：起始值（默认1）
- 模板：`{{$index + 起始值}}`

### 对象字段
- 引用当前循环对象的指定字段
- 参数：字段名
- 模板：`{{$obj.字段名}}`

### 范围值
- 引用当前范围循环的值
- 无参数
- 模板：`{{$range}}`

### 模板字符串
- 自定义模板，支持变量插值
- 参数：模板字符串
- 可使用变量：`$obj.字段名`、`$range`、`$index`

## 应用场景

交叉循环适用于以下场景：
- 传感器监测数据生成
- 设备配置参数组合
- 产品规格交叉测试
- 用户权限矩阵生成
- 实验参数组合测试

通过可视化编辑器，您可以轻松配置复杂的交叉循环逻辑，无需编写代码即可生成所需的JSON数据。